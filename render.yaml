services:
  - type: web
    name: telegram-video-bot
    env: python
    plan: free
    buildCommand: |
      # Install system dependencies
      apt-get update && apt-get install -y ffmpeg wget unzip
      
      # Install N_m3u8DL-RE for DRM support
      wget -q https://github.com/nilaoda/N_m3u8DL-RE/releases/latest/download/N_m3u8DL-RE_Beta_linux-x64.tar.gz
      tar -xzf N_m3u8DL-RE_Beta_linux-x64.tar.gz
      chmod +x N_m3u8DL-RE
      mv N_m3u8DL-RE /usr/local/bin/
      
      # Install Python dependencies
      pip install -r requirements.txt
    startCommand: python bot.py
    envVars:
      - key: API_ID
        sync: false
      - key: API_HASH
        sync: false
      - key: BOT_TOKEN
        sync: false
      - key: OWNER_ID
        sync: false
      - key: DEVELOPER_NAME
        value: "Your Name"
      - key: SUPPORT_CONTACT
        value: "@yourusername"
      - key: MONGODB_URI
        sync: false
      - key: AUTH_USERS
        value: ""
      - key: ENABLE_PUBLIC_USE
        value: "True"
      - key: PYTHON_VERSION
        value: "3.11.9"
      - key: PYTHONUNBUFFERED
        value: "1"
    autoDeploy: true
